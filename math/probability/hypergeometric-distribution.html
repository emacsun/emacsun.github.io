<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>超几何分布</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="zcl.space" />
<meta name="keywords" content="probability" />
<link rel="stylesheet" type="text/css" href="../../css/worg.css" />
<a id="home" href="../../index.html"><img src="../../img/assets/home.png" ></a>
<a id="pdf" href="hypergeometric-distribution.pdf"><img src="../../img/assets/pdf.png"></a>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2017 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "left",
        displayIndent: "3em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">超几何分布</h1>
<div id="table-of-contents">
<h2>目录</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgd274e10">1. 定义</a></li>
<li><a href="#orgfe7f605">2. 超几何分布的期望和方差</a></li>
<li><a href="#org86449aa">3. 例子</a></li>
<li><a href="#org8c1e17a">4. 超几何分布和二项分布的关系</a></li>
</ul>
</div>
</div>


<div id="outline-container-orgd274e10" class="outline-2">
<h2 id="orgd274e10"><span class="section-number-2">1</span> 定义</h2>
<div class="outline-text-2" id="text-1">
<p>

</p>

<p>
设一个坛子里一共有\(N\)个球，其中\(m\)个白球，\(N-m\)个黑球，从中随机的（无放回）取出\(n\)个球，令\(X\)表示取出来的白球数，那么：
</p>
\begin{equation}
\label{eq:1}
P\{X = i\} = \frac{\binom{m}{i} \binom{N-m}{n-i}}{\binom{N}{n}},\quad i = 0,1,\ldots ,n
\end{equation}

<p>
一个随机变量\(X\)，如果其概率分布满足式 (\ref{eq:1})就说\(X\)服从超几何分布。
</p>
</div>
</div>
<div id="outline-container-orgfe7f605" class="outline-2">
<h2 id="orgfe7f605"><span class="section-number-2">2</span> 超几何分布的期望和方差</h2>
<div class="outline-text-2" id="text-2">
<p>

</p>

<p>
我们采用和 <a href="binary-distribution.html">二项分布</a> 类似的计算方法。
</p>
\begin{eqnarray}
\label{eq:2}
E[X^{k}]&=& \sum_{i=0}^{n}i^{k}P\{X=i\} \\
&=& \sum_{i=1}^{n}i^{k}\binom{m}{i}\binom{N-m}{n-i}/\binom{N}{n}\\
&=&\frac{mn}{N}\sum_{i=1}^{n}i^{k-1}\binom{m-1}{i-1}\binom{N-m}{n-i}/\binom{N-1}{n-1}\\
&=&\frac{mn}{N}\sum_{j=0}^{n-1}(j+1)^{k-1}\frac{\binom{m-1}{j}\binom{N-m}{n-1-j}}{\binom{N-1}{n-1}}\\
&=& \frac{mn}{N}E[(Y+1)^{k-1}]
\end{eqnarray}

<p>
其中\(Y\)是参数为\((n-1,N-1,m-1)\)的超几何随机变量。在上式的求解过程中，我们用到了两个恒等式：
</p>
\begin{eqnarray}
\label{eq:3}
i\binom{m}{i}&=&m\binom{m-1}{i-1} \\
n\binom{N}{n}&=&N\binom{N-1}{n-1}
\end{eqnarray}

<p>
对于式 (\ref{eq:2})，我们令\(k=1\)，所以有：
</p>
\begin{equation}
\label{eq:4}
E[X] = \binom{mn}{N}
\end{equation}
<p>
换句话说，如果从\(N\)个球（其中有\(m\)个白球）中随机抽取\(n\)个，那么其中白球数的期望为\(mn/N\)。
</p>

<p>
对于式 (\ref{eq:2})，令\(k=2\)，则有：
</p>
\begin{eqnarray}
\label{eq:5}
E[X^{2}]&=& \frac{mn}{N}E[Y+1] \\
&=& \frac{mn}{N}\bigg[ \frac{(n-1)(m-1)}{N-1} + 1 \bigg]
\end{eqnarray}

<p>
另外\(E[X] = mn/N\)，所以我们有：
</p>
\begin{equation}
\label{eq:6}
\mathrm{Var}(X) = \frac{mn}{N}\bigg[ \frac{(n-1)(m-1)}{N-1} + 1 - \frac{mn}{N}\bigg]
\end{equation}
<p>
令\(p=m/N\)，并利用恒等式：
</p>
\begin{equation}
\label{eq:7}
\frac{m-1}{N-1} = \frac{Np-1}{N-1} = p - \frac{1-p}{N-1}
\end{equation}
<p>
得到：
</p>
\begin{equation}
\label{eq:8}
\mathrm{Var}(X) = np(1-p)(1-\tfrac{n-1}{N-1})
\end{equation}

<p>
对于超几何分布，我们知道期望为\(\frac{mn}{N} = np ,p = \frac{m}{N}\),\(p\)是白球的比例。当\(N\)很大时，观察 (\ref{eq:8})，我们有：
</p>
\begin{equation}
\label{eq:9}
\mathrm{Var}[X] \approx np(1-p)
\end{equation}

<p>
回忆二项分布，我们很容易发现其和超几何分布的相似性。
</p>
</div>
</div>
<div id="outline-container-org86449aa" class="outline-2">
<h2 id="org86449aa"><span class="section-number-2">3</span> 例子</h2>
<div class="outline-text-2" id="text-3">
<p>

</p>

<p>
栖息于某个地区的动物个体总数为\(N\)，为了得到这个\(N\)的大致估计，神态学家常常做这样的试验：先捉住\(m\)个，然后打上标签，放回大自然。过一段时间，等这\(m\)个动物充分分散到其他动物中的时，再捕捉\(n\)个。假设\(X\)为第二批捕捉的\(n\)个动物中带标记的个数。如果前后两次捕捉过程中动物的总数没有发生变化，而且捉住每一只动物的可能性是一样的，那么\(X\)为一超几何随机变量，满足：
</p>
\begin{equation}
\label{eq:10}
P\{X = i\} = \frac{\binom{m}{i} \binom{N-m}{n-i}}{\binom{N}{n}} = P_{i}(N)
\end{equation}
<p>
现在假设\(i\)为\(X\)的观测值，那么因为\(P_{i}(N)\)表示该地区事实上总共有\(N\)个动物的条件下观测时间\(X\)的取值的概率，故使\(P_{i}(N)\)达到最大值的\(N\)值应当是动物个体总数\(N\)的一个合理估计。这样的估计称为极大似然估计估计。
</p>

<p>
求\(P_{i}(N)\)最大值的最简单的方法是：首先注意
</p>
\begin{equation}
\label{eq:11}
\frac{P_{i}(N)}{P_{i}(N-1)} = \frac{(N-m)(N-n)}{N(N-m-n+i)}
\end{equation}
<p>
使上式中的比值大于1，则有：
</p>
\begin{equation}
\label{eq:12}
(N-m)(N-n) \geq N(N-m-n+i)
\end{equation}
<p>
或者必须有：
</p>
\begin{equation}
\label{eq:13}
N \leq \frac{mn}{i}
\end{equation}
<p>
所以\(P_{i}(N)\)值是先上升然后下降。且在不超过\(mn/i\)的最大整数处达到其最大值。这个最大整数就是\(N\)的最大似然估计。
</p>

<p>
上述估计还可以这样求得：假设在这个地区内有标记的动物所占的比例为\(m/N\)，应当近似的等于第二次捕捉的动物中做过标记的动物所占的比例\(i/n\)。
</p>
</div>
</div>
<div id="outline-container-org8c1e17a" class="outline-2">
<h2 id="org8c1e17a"><span class="section-number-2">4</span> 超几何分布和二项分布的关系</h2>
<div class="outline-text-2" id="text-4">
<p>

</p>

<p>
从\(N\)个球（白球比例为\(p = m/N\)）中，无放回随机抽取\(n\)个球，那么取中的白球数为超几何分布随机变量。如果对于\(n\)来讲，\(m\)和\(N\)都很大，那么有放回和无放回取球没什么差别，因为当\(m\)和\(N\)很大时，不管前面取了哪个球，接下来的取到的失败求的概率任然近似于\(p\)。换言之，当\(m\)和\(N\)相比\(n\)很大时，\(X\)的分布列应该近似等于参数为\((n,p)\)的二项随机变量的分布列。为了证明这个直觉，注意，如果\(X\)是超几何分布，那么对于\(i\leq n\)有：
</p>
\begin{eqnarray}
\label{eq:15}
P\{X=i\}&=& \frac{\binom{m}{i}\binom{N-m}{n-i}}{\binom{N}{n}} \\
&=&\frac{m!}{(m-i)!i!}\frac{(N-m)!}{(N-m-n+i)!(n-i)!}\frac{(N-n)!n!}{N!}\\
&=&\binom{n}{i} \frac{m}{N}\frac{m-1}{N-1}\cdots\frac{m-i+1}{N-i+1}\frac{N-m}{N-i}\frac{N-m-1}{N-i-1}\cdots \frac{N-m-(n-i-1)}{N-i-(n-i-1)} \\
&=&\binom{n}{i}p^{i}(1-p)^{n-i}
\end{eqnarray}
<p>
其中最后一个等式成立的条件时\(p=m/N\)且\(m,N\)相对于\(n\)和\(i\)都很大。我们在求超几何变量的期望和方差时也验证了这个结论。
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'zclspace';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</div>
</body>
</html>
