<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Thinking in Java chapter6 笔记和习题</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="emacsun" />
<link rel="stylesheet" type="text/css" href="../../css/worg.css"  />
<a id="home" href="../../index.html"><img src="../../img/assets/home.png" ></a>
<a id="pdf"  href="./TIJ-ch06.pdf"><img src="../../img/assets/pdf.png"></a>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Thinking in Java chapter6 笔记和习题</h1>
<div id="table-of-contents">
<h2>目录</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orge244600">1. 简介</a></li>
<li><a href="#org1c452f6">2. 默认的 <code>constructor</code> 和带参数的 <code>constructor</code></a></li>
<li><a href="#org67ffa96">3. 从 <code>constructor</code> 的定义引入函数重载</a></li>
<li><a href="#org1b5c189">4. 默认的 <code>constructor</code></a></li>
<li><a href="#org46f2767">5. <code>this</code> 的作用</a></li>
<li><a href="#org0da4977">6. 理解 <code>static</code></a></li>
<li><a href="#orge35bef3">7. <code>class</code> 成员初始化</a></li>
<li><a href="#orgeb11cf7">8. 初始化顺序</a></li>
<li><a href="#orge602ee0">9. <code>static</code> 类型的初始化</a></li>
<li><a href="#org4cc6eed">10. 显示初始化</a></li>
<li><a href="#orgd716c04">11. 非静态实例初始化</a></li>
<li><a href="#org5e7a1d9">12. 数组初始化</a></li>
</ul>
</div>
</div>

<div id="outline-container-orge244600" class="outline-2">
<h2 id="orge244600"><span class="section-number-2">1</span> 简介</h2>
<div class="outline-text-2" id="text-1">
<p>
<b>Initialization and Cleanup</b> 这一章首先讲述类初始化的一些操作，顺带初始化操作阐述了方法重载。然后讲述了Java的Garbage Collector机制。其中关于 <code>static</code> 初始化的例子最为令人印象深刻，我把那个“橱柜”的代码做了逐行解析，学完之后感觉非常顺畅。
</p>
</div>
</div>

<div id="outline-container-org1c452f6" class="outline-2">
<h2 id="org1c452f6"><span class="section-number-2">2</span> 默认的 <code>constructor</code> 和带参数的 <code>constructor</code></h2>
<div class="outline-text-2" id="text-2">
<p>

</p>

<p>
首先默认的 <code>constructor</code> ，看代码：
</p>
<pre class="example">
import java.util.*;
import static net.mindview.util.Print.*;
class Rock{
    Rock(){
        System.out.println("Rock");
    }
}
public class SimpleConstructor
{
    public static void main(String args[])
    {
        for (int i=0; i &lt; 10 ;i++) {
            new Rock();
        }
    }
}
</pre>

<p>
注意:  <code>constructor</code> 是一个函数，其名称和 <code>class</code> 的名称必须相同(没有为什么，这是规定)。但是没有说明这个函数可不可以携带参数，实际上是可以的， 继续看代码：
</p>
<pre class="example">
import java.util.*;
import static net.mindview.util.Print.*;
class Rock{
    Rock(int i){
        System.out.print("Rock" + i);
    }
}
public class SimpleConstructor2
{
    public static void main(String args[])
    {
        for (int i=0; i &lt; 10 ;i++) {
            new Rock(i);
        }
    }
}
</pre>
<p>
这段代码的输出是:
</p>
<pre class="example">
Rock 0 Rock 1 Rock 2 Rock 3 Rock 4 Rock 5 Rock 6 Rock 7 Rock 8 Rock 9
</pre>
<p>
注意在这段代码中使用了 <code>print</code> 而不是 <code>println</code> . <code>print</code> 输出默认不带回车； <code>println</code> 输出默认带回车。
</p>

<p>
<code>constructor</code> 函数没有返回值，注意这里的没有返回值和 <code>void</code> 函数是两回事。
</p>

<p>
<code>String</code> 对象初始化值是 <code>null</code>, 看代码：
</p>
<pre class="example">
import java.util.*;
import static net.mindview.util.Print.*;
class Rock{
    String str;
}
public class Exercise0601
{
    public static void main(String args[])
    {
        Rock rcok = new Rock();
        print("" + rcok.str);
    }
}
</pre>

<p>
其输出为
</p>
<pre class="example">
null
</pre>
</div>
</div>

<div id="outline-container-org67ffa96" class="outline-2">
<h2 id="org67ffa96"><span class="section-number-2">3</span> 从 <code>constructor</code> 的定义引入函数重载</h2>
<div class="outline-text-2" id="text-3">
<p>

</p>

<p>
作者从 <code>constructor</code> 过度到另一个知识点 <code>overload</code> , 平滑自然。对于重载，值得注意的是 <code>primitive</code> 类型的重载。 看代码：
</p>
<pre class="example">
import static net.mindview.util.Print.*;
public class PrimitiveOverloading{
    void f1(char x){printnb("f1(char) ");}
    void f1(byte x){printnb("f1(byte) ");}
    void f1(short x){printnb("f1(short) ");}
    void f1(int x){printnb("f1(int) ");}
    void f1(long x){printnb("f1(long) ");}
    void f1(float x){printnb("f1(float) ");}
    void f1(double x){printnb("f1(double) ");}

    void f2(byte x){printnb("f2(byte) ");}
    void f2(short x){printnb("f2(short) ");}
    void f2(int x){printnb("f2(int) ");}
    void f2(long x){printnb("f2(long) ");}
    void f2(float x){printnb("f2(float) ");}
    void f2(double x){printnb("f2(double) ");}

    void f3(short x){printnb("f3(short) ");}
    void f3(int x){printnb("f3(int) ");}
    void f3(long x){printnb("f3(long) ");}
    void f3(float x){printnb("f3(float) ");}
    void f3(double x){printnb("f3(double) ");}

    void f4(int x){printnb("f4(int) ");}
    void f4(long x){printnb("f4(long) ");}
    void f4(float x){printnb("f4(float) ");}
    void f4(double x){printnb("f4(double) ");}

    void f5(long x){printnb("f5(long) ");}
    void f5(float x){printnb("f5(float) ");}
    void f5(double x){printnb("f5(double) ");}

    void f6(float x){printnb("f6(float) ");}
    void f6(double x){printnb("f6(double) ");}

    void f7(double x){printnb("f7(double) ");}

    void testConstVal(){
        printnb("5: ");
        f1(5);f2(5);f3(5);f4(5);f5(5);f6(5);f7(5);print();
    }

    void testChar(){
        char x = 'x';
        printnb("char: ");
        f1(x);f2(x);f3(x);f4(x);f5(x);f6(x);f7(x);print();
    }

    void testByte(){
        byte x = 0;
        printnb("byte: ");
        f1(x);f2(x);f3(x);f4(x);f5(x);f6(x);f7(x);print();
    }

    void testShort(){
        short x = 0;
        printnb("short: ");
        f1(x);f2(x);f3(x);f4(x);f5(x);f6(x);f7(x);print();
    }

    void testInt(){
        int x = 0;
        printnb("int: ");
        f1(x);f2(x);f3(x);f4(x);f5(x);f6(x);f7(x);print();
    }

    void testLong(){
        long x = 0;
        printnb("long: ");
        f1(x);f2(x);f3(x);f4(x);f5(x);f6(x);f7(x);print();
    }

    void testFloat(){
        float x = 0;
        printnb("float: ");
        f1(x);f2(x);f3(x);f4(x);f5(x);f6(x);f7(x);print();
    }

    void testDouble(){
        double x = 0;
        printnb("double: ");
        f1(x);f2(x);f3(x);f4(x);f5(x);f6(x);f7(x);print();
    }

    public static void main(String[] args){
        PrimitiveOverloading p = new PrimitiveOverloading();
        p.testConstVal();
        p.testChar();
        p.testByte();
        p.testShort();
        p.testInt();
        p.testLong();
        p.testFloat();
        p.testDouble();
    }
}
</pre>
<p>
这段代码的输出是:
</p>
<pre class="example">
5: f1(int) f2(int) f3(int) f4(int) f5(long) f6(float) f7(double) 
char: f1(char) f2(int) f3(int) f4(int) f5(long) f6(float) f7(double) 
byte: f1(byte) f2(byte) f3(short) f4(int) f5(long) f6(float) f7(double) 
short: f1(short) f2(short) f3(short) f4(int) f5(long) f6(float) f7(double) 
int: f1(int) f2(int) f3(int) f4(int) f5(long) f6(float) f7(double) 
long: f1(long) f2(long) f3(long) f4(long) f5(long) f6(float) f7(double) 
float: f1(float) f2(float) f3(float) f4(float) f5(float) f6(float) f7(double) 
double: f1(double) f2(double) f3(double) f4(double) f5(double) f6(double) f7(double)
</pre>
</div>
</div>
<div id="outline-container-org1b5c189" class="outline-2">
<h2 id="org1b5c189"><span class="section-number-2">4</span> 默认的 <code>constructor</code></h2>
<div class="outline-text-2" id="text-4">
<p>

</p>

<p>
默认的 <code>constructor</code> 是没有参数的。如果定义类时没有指定构造函数，那么编译器会生成一个默认的构造函数。如果在定义类时指定了构造函数，那么在创建该类的对象时就需要指定该对象实用的构造函数，而不能使用默认构造函数，否则就会报错。看代码：
</p>
<div class="org-src-container">
<pre class="src src-java"><span class="linenr"> 1: </span><span style="color: #859900; font-weight: bold;">class</span> <span style="color: #b58900;">Bird</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 2: </span>    <span style="color: #268bd2;">Bird</span><span style="color: #b58900;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">i</span><span style="color: #b58900;">){}</span>
<span class="linenr"> 3: </span>    <span style="color: #268bd2;">Bird</span><span style="color: #b58900;">(</span><span style="color: #b58900;">double</span> <span style="color: #268bd2;">d</span><span style="color: #b58900;">){}</span>
<span class="linenr"> 4: </span><span style="color: #2aa198;">}</span>
<span class="linenr"> 5: </span><span style="color: #859900; font-weight: bold;">public</span> <span style="color: #859900; font-weight: bold;">class</span> <span style="color: #b58900;">NoSynthesis</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 6: </span>    <span style="color: #859900; font-weight: bold;">public</span> <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span><span style="color: #268bd2;">[]</span> <span style="color: #268bd2;">args</span><span style="color: #b58900;">){</span>
<span class="linenr"> 7: </span>        <span style="color: #b58900;">Bird</span> <span style="color: #268bd2;">b2</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Bird</span><span style="color: #268bd2;">(</span><span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 8: </span>        <span style="color: #b58900;">Bird</span> <span style="color: #268bd2;">b3</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Bird</span><span style="color: #268bd2;">(</span><span style="color: #6c71c4;">1</span>.<span style="color: #6c71c4;">0</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 9: </span>        <span style="color: #b58900;">Bird</span> <span style="color: #268bd2;">b4</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Bird</span><span style="color: #268bd2;">()</span>;
<span class="linenr">10: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">11: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
这个代码会报错：
</p>
<pre class="example">
error: no suitable constructor found for Bird(no arguments)
        Bird b4 = new Bird();
                  ^
    constructor Bird.Bird(int) is not applicable
      (actual and formal argument lists differ in length)
    constructor Bird.Bird(double) is not applicable
      (actual and formal argument lists differ in length)
1 error
</pre>

<p>
编译器会认为没有无参数的构造函数定义。对代码进行修改：
</p>
<div class="org-src-container">
<pre class="src src-java"><span class="linenr"> 1: </span><span style="color: #859900; font-weight: bold;">class</span> <span style="color: #b58900;">Bird</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 2: </span>    <span style="color: #268bd2;">Bird</span><span style="color: #b58900;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">i</span><span style="color: #b58900;">){}</span>
<span class="linenr"> 3: </span>    <span style="color: #268bd2;">Bird</span><span style="color: #b58900;">(</span><span style="color: #b58900;">double</span> <span style="color: #268bd2;">d</span><span style="color: #b58900;">){}</span>
<span class="linenr"> 4: </span><span style="color: #2aa198;">}</span>
<span class="linenr"> 5: </span><span style="color: #859900; font-weight: bold;">public</span> <span style="color: #859900; font-weight: bold;">class</span> <span style="color: #b58900;">NoSynthesis</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 6: </span>    <span style="color: #859900; font-weight: bold;">public</span> <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span><span style="color: #268bd2;">[]</span> <span style="color: #268bd2;">args</span><span style="color: #b58900;">){</span>
<span class="linenr"> 7: </span>        <span style="color: #b58900;">Bird</span> <span style="color: #268bd2;">b2</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Bird</span><span style="color: #268bd2;">(</span><span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 8: </span>        <span style="color: #b58900;">Bird</span> <span style="color: #268bd2;">b3</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Bird</span><span style="color: #268bd2;">(</span><span style="color: #6c71c4;">1</span>.<span style="color: #6c71c4;">0</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 9: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">10: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
就没有报错。但是，看代码：
</p>
<div class="org-src-container">
<pre class="src src-java"><span class="linenr"> 1: </span><span style="color: #859900; font-weight: bold;">class</span> <span style="color: #b58900;">Bird</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 2: </span>    <span style="color: #268bd2;">Bird</span><span style="color: #b58900;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">i</span><span style="color: #b58900;">){}</span>
<span class="linenr"> 3: </span>    <span style="color: #268bd2;">Bird</span><span style="color: #b58900;">(</span><span style="color: #b58900;">double</span> <span style="color: #268bd2;">d</span><span style="color: #b58900;">){}</span>
<span class="linenr"> 4: </span><span style="color: #2aa198;">}</span>
<span class="linenr"> 5: </span><span style="color: #859900; font-weight: bold;">public</span> <span style="color: #859900; font-weight: bold;">class</span> <span style="color: #b58900;">NoSynthesis</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 6: </span>    <span style="color: #859900; font-weight: bold;">public</span> <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span><span style="color: #268bd2;">[]</span> <span style="color: #268bd2;">args</span><span style="color: #b58900;">){</span>
<span class="linenr"> 7: </span>        <span style="color: #b58900;">Bird</span> <span style="color: #268bd2;">b2</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Bird</span><span style="color: #268bd2;">(</span><span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 8: </span>        <span style="color: #b58900;">Bird</span> <span style="color: #268bd2;">b3</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Bird</span><span style="color: #268bd2;">(</span><span style="color: #6c71c4;">1</span>.<span style="color: #6c71c4;">0</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 9: </span>        <span style="color: #b58900;">Bird</span> <span style="color: #268bd2;">b4</span>;
<span class="linenr">10: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">11: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
这个代码也没有报错，但是我不知道 <code>b4</code> 调用了那个构造函数。为了确认一下，对代码做如下修改：
</p>
<div class="org-src-container">
<pre class="src src-java"><span class="linenr"> 1: </span><span style="color: #859900; font-weight: bold;">class</span> <span style="color: #b58900;">Bird</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 2: </span>    <span style="color: #268bd2;">Bird</span><span style="color: #b58900;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">i</span><span style="color: #b58900;">){</span>
<span class="linenr"> 3: </span>        System.out.println<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"with int i"</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 4: </span>    <span style="color: #b58900;">}</span>
<span class="linenr"> 5: </span>    <span style="color: #268bd2;">Bird</span><span style="color: #b58900;">(</span><span style="color: #b58900;">double</span> <span style="color: #268bd2;">d</span><span style="color: #b58900;">){</span>
<span class="linenr"> 6: </span>        System.out.println<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"with double d"</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 7: </span>    <span style="color: #b58900;">}</span>
<span class="linenr"> 8: </span><span style="color: #2aa198;">}</span>
<span class="linenr"> 9: </span><span style="color: #859900; font-weight: bold;">public</span> <span style="color: #859900; font-weight: bold;">class</span> <span style="color: #b58900;">NoSynthesis</span><span style="color: #2aa198;">{</span>
<span class="linenr">10: </span>    <span style="color: #859900; font-weight: bold;">public</span> <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span><span style="color: #268bd2;">[]</span> <span style="color: #268bd2;">args</span><span style="color: #b58900;">){</span>
<span class="linenr">11: </span>        <span style="color: #b58900;">Bird</span> <span style="color: #268bd2;">b2</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Bird</span><span style="color: #268bd2;">(</span><span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span>;
<span class="linenr">12: </span>        <span style="color: #b58900;">Bird</span> <span style="color: #268bd2;">b3</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Bird</span><span style="color: #268bd2;">(</span><span style="color: #6c71c4;">1</span>.<span style="color: #6c71c4;">0</span><span style="color: #268bd2;">)</span>;
<span class="linenr">13: </span>        <span style="color: #b58900;">Bird</span> <span style="color: #268bd2;">b4</span>;
<span class="linenr">14: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">15: </span><span style="color: #2aa198;">}</span>
</pre>
</div>

<p>
输出为:
</p>
<pre class="example">
with int i
with double d
</pre>
<p>
可见 <code>Bird b4</code> 没有调用给出的两个构造函数，而是用的默认的构造函数。
</p>
</div>
</div>
<div id="outline-container-org46f2767" class="outline-2">
<h2 id="org46f2767"><span class="section-number-2">5</span> <code>this</code> 的作用</h2>
<div class="outline-text-2" id="text-5">
<p>

</p>

<p>
简而言之， <code>this</code> 用来代表当前的对象。在使用的过程中，你完全可以用 <code>this</code> 来替代当前的对象。但是 <code>this</code> 的实用也会有一些限制，比如只能在 <code>non-static</code> 的方法中使用。但是在一个类的多个方法中不需要显示的使用 <code>this</code> 来指示当前类。
</p>

<p>
<code>this</code> 的一个经常用到的地方是 <code>return</code> 语句返回一个对象。看代码：
</p>
<div class="org-src-container">
<pre class="src src-java"><span class="linenr"> 1: </span><span style="color: #859900; font-weight: bold;">public</span> <span style="color: #859900; font-weight: bold;">class</span> <span style="color: #b58900;">Leaf</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 2: </span>    <span style="color: #b58900;">int</span> <span style="color: #268bd2;">i</span>=<span style="color: #6c71c4;">0</span>;
<span class="linenr"> 3: </span>    <span style="color: #b58900;">Leaf</span> <span style="color: #268bd2;">increament</span><span style="color: #b58900;">(){</span>
<span class="linenr"> 4: </span>        i++;
<span class="linenr"> 5: </span>        <span style="color: #859900; font-weight: bold;">return</span> <span style="color: #859900; font-weight: bold;">this</span>;
<span class="linenr"> 6: </span>    <span style="color: #b58900;">}</span>
<span class="linenr"> 7: </span>    <span style="color: #b58900;">void</span> <span style="color: #268bd2;">print</span><span style="color: #b58900;">(){</span>
<span class="linenr"> 8: </span>        System.out.println<span style="color: #268bd2;">(</span><span style="color: #2aa198;">" i = "</span> + i<span style="color: #268bd2;">)</span>;
<span class="linenr"> 9: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">10: </span>    <span style="color: #859900; font-weight: bold;">public</span> <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span><span style="color: #268bd2;">[]</span> <span style="color: #268bd2;">args</span><span style="color: #b58900;">){</span>
<span class="linenr">11: </span>        <span style="color: #b58900;">Leaf</span> <span style="color: #268bd2;">x</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Leaf</span><span style="color: #268bd2;">()</span>;
<span class="linenr">12: </span>        x.increament<span style="color: #268bd2;">()</span>.increament<span style="color: #268bd2;">()</span>.print<span style="color: #268bd2;">()</span>;
<span class="linenr">13: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">14: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
结果输出为：
</p>
<pre class="example">
i = 2
</pre>
<p>
<code>this</code> 也可以用来把当前的对象传递给另外的方法，看代码：
</p>
<div class="org-src-container">
<pre class="src src-java"><span class="linenr"> 1: </span><span style="color: #859900; font-weight: bold;">class</span> <span style="color: #b58900;">Person</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 2: </span>    <span style="color: #859900; font-weight: bold;">public</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">eat</span><span style="color: #b58900;">(</span><span style="color: #b58900;">Apple</span> <span style="color: #268bd2;">apple</span><span style="color: #b58900;">){</span>
<span class="linenr"> 3: </span>        <span style="color: #b58900;">Apple</span> <span style="color: #268bd2;">peeled</span> = apple.getPeeled<span style="color: #268bd2;">()</span>;
<span class="linenr"> 4: </span>        System.out.println<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Yummy"</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 5: </span>    <span style="color: #b58900;">}</span>
<span class="linenr"> 6: </span><span style="color: #2aa198;">}</span>
<span class="linenr"> 7: </span>
<span class="linenr"> 8: </span><span style="color: #859900; font-weight: bold;">class</span> <span style="color: #b58900;">Peeler</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 9: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">Apple</span> <span style="color: #268bd2;">peel</span><span style="color: #b58900;">(</span><span style="color: #b58900;">Apple</span> <span style="color: #268bd2;">apple</span><span style="color: #b58900;">){</span>
<span class="linenr">10: </span>        <span style="color: #586e75;">//</span><span style="color: #586e75;">...remove peel</span>
<span class="linenr">11: </span>        <span style="color: #859900; font-weight: bold;">return</span> apple;
<span class="linenr">12: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">13: </span><span style="color: #2aa198;">}</span>
<span class="linenr">14: </span>
<span class="linenr">15: </span><span style="color: #859900; font-weight: bold;">class</span> <span style="color: #b58900;">Apple</span><span style="color: #2aa198;">{</span>
<span class="linenr">16: </span>    <span style="color: #b58900;">Apple</span> <span style="color: #268bd2;">getPeeled</span><span style="color: #b58900;">(){</span><span style="color: #859900; font-weight: bold;">return</span> Peeler.peel<span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">this</span><span style="color: #268bd2;">)</span>;<span style="color: #b58900;">}</span>
<span class="linenr">17: </span><span style="color: #2aa198;">}</span>
<span class="linenr">18: </span>
<span class="linenr">19: </span><span style="color: #859900; font-weight: bold;">public</span> <span style="color: #859900; font-weight: bold;">class</span> <span style="color: #b58900;">PassingThis</span><span style="color: #2aa198;">{</span>
<span class="linenr">20: </span>    <span style="color: #859900; font-weight: bold;">public</span> <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span><span style="color: #268bd2;">[]</span> <span style="color: #268bd2;">args</span><span style="color: #b58900;">){</span>
<span class="linenr">21: </span>        <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Person</span><span style="color: #268bd2;">()</span>.eat<span style="color: #268bd2;">(</span><span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Apple</span><span style="color: #6c71c4;">()</span><span style="color: #268bd2;">)</span>;
<span class="linenr">22: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">23: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
<code>this</code> 还可以用来从一个 <code>constructor</code> 中调用另一个 <code>constructor</code> 。这一用途有两点需要注意：
</p>
<ol class="org-ol">
<li>你不能在一个 <code>constructor</code> 中调用两次 <code>this</code> 初始化函数。</li>
<li>在一个 <code>constructor</code> 中，如果要使用 <code>this</code> ，第一行有效代码就应该是使用 <code>this</code> 的代码。</li>
</ol>
</div>
</div>


<div id="outline-container-org0da4977" class="outline-2">
<h2 id="org0da4977"><span class="section-number-2">6</span> 理解 <code>static</code></h2>
<div class="outline-text-2" id="text-6">
<p>

</p>

<p>
有了 <code>this</code> 我们现在可以更深刻的理解 <code>static</code> 。我们可以从 <code>non-static</code> 函数里调用 <code>static</code> 函数，但是不能从 <code>static</code> 函数里调用 <code>non-static</code> 函数。为什么? 因为在 <code>static</code> 函数里没有对象的概念。 <code>static</code> 函数依赖于 <code>class</code> 的定义存在，而不依赖于对象的存在。所以 <code>static</code> 看起来就像是一个全局方法，不依赖于对象存在。但是 <code>Java</code> 中是没有全局函数的，所以通过 <code>static</code> 可以实现类似的效果。
</p>

<p>
正是因为 <code>static</code> 的这个特性，人们诟病 <code>Java</code> 的 <code>static</code> 方法不是面向对象的。因为在 <code>static</code> 方法中，无法像一个对象发消息，因为根本没有 <code>this</code> 。因此当你的代码中有很多 <code>static</code> 的时候，你要重新审视一下你的代码结构。但是在很多时候 <code>static</code> 又是一个不得不存在的特性，在以后的章节中就会看到。
</p>
</div>
</div>
<div id="outline-container-orge35bef3" class="outline-2">
<h2 id="orge35bef3"><span class="section-number-2">7</span> <code>class</code> 成员初始化</h2>
<div class="outline-text-2" id="text-7">
<p>

</p>

<p>
<code>Java</code> 中对于 <code>class</code> 的基础类型成员都做了默认初始化。这说明，每一个基础类成员都有一个默认的构造函数，为其赋初值。看代码：
</p>
<div class="org-src-container">
<pre class="src src-java"><span class="linenr"> 1: </span><span style="color: #859900; font-weight: bold;">import</span> <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #268bd2; font-weight: bold;">net</span>.<span style="color: #268bd2; font-weight: bold;">mindview</span>.<span style="color: #268bd2; font-weight: bold;">util</span>.<span style="color: #268bd2; font-weight: bold;">Print</span>.*;
<span class="linenr"> 2: </span>
<span class="linenr"> 3: </span><span style="color: #859900; font-weight: bold;">public</span> <span style="color: #859900; font-weight: bold;">class</span>  <span style="color: #b58900;">InitialValues</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 4: </span>    <span style="color: #b58900;">boolean</span> <span style="color: #268bd2;">t</span>;
<span class="linenr"> 5: </span>    <span style="color: #b58900;">char</span> <span style="color: #268bd2;">c</span>;
<span class="linenr"> 6: </span>    <span style="color: #b58900;">byte</span> <span style="color: #268bd2;">b</span>;
<span class="linenr"> 7: </span>    <span style="color: #b58900;">short</span> <span style="color: #268bd2;">s</span>;
<span class="linenr"> 8: </span>    <span style="color: #b58900;">int</span> <span style="color: #268bd2;">i</span>;
<span class="linenr"> 9: </span>    <span style="color: #b58900;">long</span> <span style="color: #268bd2;">l</span>;
<span class="linenr">10: </span>    <span style="color: #b58900;">float</span>  <span style="color: #268bd2;">f</span>;
<span class="linenr">11: </span>    <span style="color: #b58900;">double</span> <span style="color: #268bd2;">d</span>;
<span class="linenr">12: </span>    <span style="color: #b58900;">InitialValues</span> <span style="color: #268bd2;">reference</span>;
<span class="linenr">13: </span>    <span style="color: #b58900;">void</span> <span style="color: #268bd2;">printInitiaValues</span><span style="color: #b58900;">(){</span>
<span class="linenr">14: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Data type         initial values"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">15: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"boolean           "</span>+t<span style="color: #268bd2;">)</span>;
<span class="linenr">16: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"char              "</span>+c<span style="color: #268bd2;">)</span>;
<span class="linenr">17: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"int               "</span>+i<span style="color: #268bd2;">)</span>;
<span class="linenr">18: </span>     <span style="color: #b58900;">   pr</span>int<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"long              "</span>+l<span style="color: #268bd2;">)</span>;
<span class="linenr">19: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"float             "</span>+f<span style="color: #268bd2;">)</span>;
<span class="linenr">20: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"double            "</span>+d<span style="color: #268bd2;">)</span>;
<span class="linenr">21: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"InitialValues     "</span>+reference<span style="color: #268bd2;">)</span>;
<span class="linenr">22: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">23: </span>    <span style="color: #859900; font-weight: bold;">public</span> <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span><span style="color: #268bd2;">[]</span> <span style="color: #268bd2;">args</span><span style="color: #b58900;">){</span>
<span class="linenr">24: </span>        <span style="color: #b58900;">InitialValues</span> <span style="color: #268bd2;">iv</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">InitialValues</span><span style="color: #268bd2;">()</span>;
<span class="linenr">25: </span>        iv.<span style="color: #b58900;">printInitiaValues</span><span style="color: #268bd2;">()</span>;
<span class="linenr">26: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">27: </span>
<span class="linenr">28: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
其输出为：
</p>
<pre class="example">
Data type         initial values
boolean           false
char              [ ]
int               0
long              0
float             0.0
double            0.0
InitialValues     null
</pre>
<p>
<code>char</code> 的初始值是0，打印出来是一个空格。另外需要注意的是：如果在 <code>class</code> 中定义了一个对象而没有为其赋初值，则这个对象的 <code>reference</code> 会被赋值 <code>null</code>
</p>
</div>
</div>
<div id="outline-container-orgeb11cf7" class="outline-2">
<h2 id="orgeb11cf7"><span class="section-number-2">8</span> 初始化顺序</h2>
<div class="outline-text-2" id="text-8">
<p>

</p>

<p>
在 <code>Java</code> 中，类变量的初始化先于类方法调用。什么意思？就是说：在写代码的时候，即便你把类变量的定义放在了构造函数的后面， <code>Java</code> 依然会先初始化这些变量，然后再去调用函数（这个函数通常是构造函数）。看代码：
</p>
<div class="org-src-container">
<pre class="src src-c"><span class="linenr"> 1: </span><span style="color: #b58900;">import</span> <span style="color: #859900; font-weight: bold;">static</span>  net.mindview.util.Print.*;
<span class="linenr"> 2: </span><span style="color: #b58900;">class</span> <span style="color: #268bd2;">Window</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 3: </span>    <span style="color: #268bd2;">Window</span><span style="color: #b58900;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">marker</span><span style="color: #b58900;">){</span>
<span class="linenr"> 4: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Window number: "</span> + marker<span style="color: #268bd2;">)</span>;
<span class="linenr"> 5: </span>    <span style="color: #b58900;">}</span>
<span class="linenr"> 6: </span><span style="color: #2aa198;">}</span>
<span class="linenr"> 7: </span><span style="color: #b58900;">class</span> <span style="color: #268bd2;">House</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 8: </span>    <span style="color: #b58900;">Window</span> <span style="color: #268bd2;">w1</span> = new Window<span style="color: #b58900;">(</span><span style="color: #6c71c4;">1</span><span style="color: #b58900;">)</span>;
<span class="linenr"> 9: </span>    <span style="color: #268bd2;">House</span><span style="color: #b58900;">(){</span>
<span class="linenr">10: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"House()"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">11: </span>        w3 = new Window<span style="color: #268bd2;">(</span><span style="color: #6c71c4;">33</span><span style="color: #268bd2;">)</span>;
<span class="linenr">12: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">13: </span>    <span style="color: #b58900;">Window</span> <span style="color: #268bd2;">w2</span> = new Window<span style="color: #b58900;">(</span><span style="color: #6c71c4;">2</span><span style="color: #b58900;">)</span>;
<span class="linenr">14: </span>    <span style="color: #b58900;">void</span> <span style="color: #268bd2;">f</span><span style="color: #b58900;">(){</span>
<span class="linenr">15: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"f()"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">16: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">17: </span>    <span style="color: #b58900;">Window</span> <span style="color: #268bd2;">w3</span> = new Window<span style="color: #b58900;">(</span><span style="color: #6c71c4;">3</span><span style="color: #b58900;">)</span>;
<span class="linenr">18: </span><span style="color: #2aa198;">}</span>
<span class="linenr">19: </span>public <span style="color: #b58900;">class</span> <span style="color: #268bd2;">OrderOfInitialization</span>
<span class="linenr">20: </span><span style="color: #2aa198;">{</span>
<span class="linenr">21: </span>    public <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span> <span style="color: #268bd2;">args</span><span style="color: #268bd2;">[]</span><span style="color: #b58900;">)</span>
<span class="linenr">22: </span>    <span style="color: #b58900;">{</span>
<span class="linenr">23: </span>        <span style="color: #b58900;">House</span> <span style="color: #268bd2;">h</span> = new House<span style="color: #268bd2;">()</span>;
<span class="linenr">24: </span>        h.f<span style="color: #268bd2;">()</span>;
<span class="linenr">25: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">26: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
输出为：
</p>
<pre class="example">
Window number: 1
Window number: 2
Window number: 3
House()
Window number: 33
f()
</pre>

<p>
从代码中我们可以看到， <code>House</code> 的构造函数在 <code>w1</code> 和 <code>w2</code> 之间。但是我们执行 <code>House h = new House()</code> 这一行代码时，初始化的执行顺序是： 
</p>
<ol class="org-ol">
<li>初始化  <code>w1</code></li>
<li>初始化 <code>w2</code></li>
<li>初始化 <code>w3</code></li>
<li>调用 <code>House()</code> 对 <code>w3</code> 再次初始化。</li>
</ol>
</div>
</div>

<div id="outline-container-orge602ee0" class="outline-2">
<h2 id="orge602ee0"><span class="section-number-2">9</span> <code>static</code> 类型的初始化</h2>
<div class="outline-text-2" id="text-9">
<p>

</p>

<p>
无论创建了多少个对象， <code>static</code> 类型的数据都只占用一份存储。只有 <code>class</code> 的域可以是 <code>static</code> ，一个本地变量不能是 <code>static</code> 类型的。接下来我们通过一个例子来查看 <code>static</code> 是如何初始化的, 看代码:
</p>
<div class="org-src-container">
<pre class="src src-c"><span class="linenr"> 1: </span><span style="color: #586e75;">// </span><span style="color: #586e75;">specifying initial values in a class definition</span>
<span class="linenr"> 2: </span><span style="color: #b58900;">import</span> <span style="color: #859900; font-weight: bold;">static</span> net.mindview.util.Print.*;
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span><span style="color: #b58900;">class</span> <span style="color: #268bd2;">Bowl</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 5: </span>    <span style="color: #268bd2;">Bowl</span><span style="color: #b58900;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">marker</span><span style="color: #b58900;">){</span>
<span class="linenr"> 6: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Bowl("</span> + marker + <span style="color: #2aa198;">")"</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 7: </span>    <span style="color: #b58900;">}</span>
<span class="linenr"> 8: </span>    <span style="color: #b58900;">void</span> <span style="color: #268bd2;">f1</span><span style="color: #b58900;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">marker</span><span style="color: #b58900;">){</span>
<span class="linenr"> 9: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"f1("</span> + marker + <span style="color: #2aa198;">")"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">10: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">11: </span><span style="color: #2aa198;">}</span>
<span class="linenr">12: </span>
<span class="linenr">13: </span><span style="color: #b58900;">class</span> <span style="color: #268bd2;">Table</span><span style="color: #2aa198;">{</span>
<span class="linenr">14: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">Bowl</span> <span style="color: #268bd2;">bowl</span> =new Bowl<span style="color: #b58900;">(</span><span style="color: #6c71c4;">1</span><span style="color: #b58900;">)</span>;
<span class="linenr">15: </span>    <span style="color: #268bd2;">Table</span><span style="color: #b58900;">(){</span>
<span class="linenr">16: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Table()"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">17: </span>        bowl2.f1<span style="color: #268bd2;">(</span><span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span>;
<span class="linenr">18: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">19: </span>    <span style="color: #b58900;">void</span> <span style="color: #268bd2;">f2</span><span style="color: #b58900;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">marker</span><span style="color: #b58900;">){</span>
<span class="linenr">20: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"f2("</span> + marker + <span style="color: #2aa198;">")"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">21: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">22: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">Bowl</span> <span style="color: #268bd2;">bowl2</span> = new Bowl<span style="color: #b58900;">(</span><span style="color: #6c71c4;">2</span><span style="color: #b58900;">)</span>;
<span class="linenr">23: </span><span style="color: #2aa198;">}</span>
<span class="linenr">24: </span>
<span class="linenr">25: </span><span style="color: #b58900;">class</span> <span style="color: #268bd2;">Cupboard</span><span style="color: #2aa198;">{</span>
<span class="linenr">26: </span>    <span style="color: #b58900;">Bowl</span> <span style="color: #268bd2;">bowl3</span> = new Bowl<span style="color: #b58900;">(</span><span style="color: #6c71c4;">3</span><span style="color: #b58900;">)</span>;
<span class="linenr">27: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">Bowl</span> <span style="color: #268bd2;">bowl4</span> = new Bowl<span style="color: #b58900;">(</span><span style="color: #6c71c4;">4</span><span style="color: #b58900;">)</span>;
<span class="linenr">28: </span>    <span style="color: #268bd2;">Cupboard</span><span style="color: #b58900;">(){</span>
<span class="linenr">29: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Cupboard()"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">30: </span>        bowl4.f1<span style="color: #268bd2;">(</span><span style="color: #6c71c4;">2</span><span style="color: #268bd2;">)</span>;
<span class="linenr">31: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">32: </span>    <span style="color: #b58900;">void</span> <span style="color: #268bd2;">f3</span><span style="color: #b58900;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">marker</span><span style="color: #b58900;">){</span>
<span class="linenr">33: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"f3("</span> + marker + <span style="color: #2aa198;">")"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">34: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">35: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">Bowl</span> <span style="color: #268bd2;">bowl5</span> =new Bowl<span style="color: #b58900;">(</span><span style="color: #6c71c4;">5</span><span style="color: #b58900;">)</span>;
<span class="linenr">36: </span><span style="color: #2aa198;">}</span>
<span class="linenr">37: </span>public <span style="color: #b58900;">class</span> <span style="color: #268bd2;">StaticInitialization</span>
<span class="linenr">38: </span><span style="color: #2aa198;">{</span>
<span class="linenr">39: </span>    public <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span> <span style="color: #268bd2;">args</span><span style="color: #268bd2;">[]</span><span style="color: #b58900;">)</span>
<span class="linenr">40: </span>    <span style="color: #b58900;">{</span>
<span id="coderef-print1" class="coderef-off"><span class="linenr">41: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Creating new Cupboard() in main"</span><span style="color: #268bd2;">)</span>;</span>
<span id="coderef-Cupboard1" class="coderef-off"><span class="linenr">42: </span>        <span style="color: #b58900;">new</span> <span style="color: #268bd2;">Cupboard</span><span style="color: #268bd2;">()</span>;</span>
<span id="coderef-print2" class="coderef-off"><span class="linenr">43: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Creating new Cupboard() in main"</span><span style="color: #268bd2;">)</span>;</span>
<span id="coderef-Cupboard2" class="coderef-off"><span class="linenr">44: </span>        <span style="color: #b58900;">new</span> <span style="color: #268bd2;">Cupboard</span><span style="color: #268bd2;">()</span>;</span>
<span class="linenr">45: </span>        table.f2<span style="color: #268bd2;">(</span><span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span>;
<span class="linenr">46: </span>        cupboard.f3<span style="color: #268bd2;">(</span><span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span>;
<span class="linenr">47: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">48: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">Table</span> <span style="color: #268bd2;">table</span> = new Table<span style="color: #b58900;">()</span>;
<span class="linenr">49: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">Cupboard</span> <span style="color: #268bd2;">cupboard</span> = new Cupboard<span style="color: #b58900;">()</span>;
<span class="linenr">50: </span><span style="color: #2aa198;">}</span>
</pre>
</div>

<p>
这段代码是我目前敲过的最长的 Java代码，其输出也最长，看输出:
</p>
<pre class="example">
Bowl(1)
Bowl(2)
Table()
f1(1)
Bowl(4)
Bowl(5)
Bowl(3)
Cupboard()
f1(2)
Creating new Cupboard() in main
Bowl(3)
Cupboard()
f1(2)
Creating new Cupboard() in main
Bowl(3)
Cupboard()
f1(2)
f2(1)
f3(1)
</pre>

<p>
让我们来仔细分析一下每一行的输出是怎么来的。通过 <code>Bowl</code> 我们可以知道初始化的顺序。当我们调用 <code>main()</code> 时，首先初始化的是 <code>StaticInitialization</code> 中的 <code>static</code> 成员，然后是 <code>non-static</code> 成员。在这个代码中是先初始化最后两行的 <code>table</code> 和 <code>cupboard</code> 。
</p>

<p>
在初始化 <code>table</code> 过程中，生成了前四行输出。 具体过程是：先初始化 <code>Table</code> 的 <code>bowl1</code> 和 <code>bowl(2)</code> 然后调用构造函数 <code>Table()</code> 生成第三行第四行输出。
</p>

<p>
在初始化 <code>cupboard</code> 过程中，生成了接下来的五行输出。具体过程是：先初始化 <code>bowl(4)</code> 和 <code>bowl(5)</code> 然后初始化 <code>bowl3</code> 最后调用 <code>Cupboard()</code> 构造函数。
</p>

<p>
<code>table</code> 和 <code>cupboard</code> 初始化结束后， 接下来执行第 <a href="#coderef-print1" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-print1');" onmouseout="CodeHighlightOff(this, 'coderef-print1');">41</a> 行打印了一句提示，然后执行第<a href="#coderef-Cupboard1" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-Cupboard1');" onmouseout="CodeHighlightOff(this, 'coderef-Cupboard1');">42</a> 行，这个时候由于 <code>bowl4</code> 和 <code>bowl5</code> 已经被初始化了，所以只初始化了 <code>bowl3</code> 并调用了 <code>Cupboard()</code> 构造函数。
</p>

<p>
然后执行第 <a href="#coderef-print2" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-print2');" onmouseout="CodeHighlightOff(this, 'coderef-print2');">43</a> 行，同样的只初始化了 <code>bowl3</code> 并调用了 <code>Cupboard()</code> 构造函数。
</p>

<p>
最后调用 <code>table.f2(2)</code> 和 <code>cupboard.f3(1)</code> 生成最后两行输出。
</p>
</div>
</div>
<div id="outline-container-org4cc6eed" class="outline-2">
<h2 id="org4cc6eed"><span class="section-number-2">10</span> 显示初始化</h2>
<div class="outline-text-2" id="text-10">
<p>

</p>

<p>
在 <code>Java</code> 中可以使用 <code>static</code> 语句初始化（有时候我们叫之中初始化方式为 <code>static</code> 块）。看代码：
</p>
<div class="org-src-container">
<pre class="src src-java"><span class="linenr">1: </span><span style="color: #859900; font-weight: bold;">public</span> <span style="color: #859900; font-weight: bold;">class</span> <span style="color: #b58900;">Spoon</span><span style="color: #2aa198;">{</span>
<span class="linenr">2: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">int</span> <span style="color: #268bd2;">i</span>;
<span class="linenr">3: </span>    <span style="color: #859900; font-weight: bold;">static</span><span style="color: #b58900;">{</span>
<span class="linenr">4: </span>        i = <span style="color: #6c71c4;">47</span>;
<span class="linenr">5: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">6: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
看起来像是一个方法，但是注意这种初始化方法仅仅是一个 <code>static</code> 关键词跟着一个语句块。同其他 <code>static</code> 初始化语句一样，使用 <code>static</code> 块的初始化也仅仅执行一次。看代码：
</p>
<div class="org-src-container">
<pre class="src src-C++"><span class="linenr"> 1: </span><span style="color: #859900; font-weight: bold;">class</span> <span style="color: #b58900;">Cup</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 2: </span>  <span style="color: #268bd2;">Cup</span><span style="color: #b58900;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">marker</span><span style="color: #b58900;">){</span>
<span class="linenr"> 3: </span>    print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Cup("</span> + marker + <span style="color: #2aa198;">")"</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 4: </span>  <span style="color: #b58900;">}</span>
<span class="linenr"> 5: </span>  <span style="color: #b58900;">void</span> <span style="color: #268bd2;">f</span><span style="color: #b58900;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">marker</span><span style="color: #b58900;">){</span>
<span class="linenr"> 6: </span>    print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"f("</span> + marker + <span style="color: #2aa198;">")"</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 7: </span>  <span style="color: #b58900;">}</span>
<span class="linenr"> 8: </span><span style="color: #2aa198;">}</span>
<span class="linenr"> 9: </span>
<span class="linenr">10: </span><span style="color: #859900; font-weight: bold;">class</span> <span style="color: #b58900;">Cups</span><span style="color: #2aa198;">{</span>
<span class="linenr">11: </span>  <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">Cup</span> <span style="color: #268bd2;">cup1</span>;
<span class="linenr">12: </span>  <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">Cup</span> <span style="color: #268bd2;">cup2</span>;
<span class="linenr">13: </span>  <span style="color: #859900; font-weight: bold;">static</span><span style="color: #b58900;">{</span>
<span class="linenr">14: </span>    cup1 = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Cup</span><span style="color: #268bd2;">(</span><span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span>;
<span class="linenr">15: </span>    cup2 = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Cup</span><span style="color: #268bd2;">(</span><span style="color: #6c71c4;">2</span><span style="color: #268bd2;">)</span>;
<span class="linenr">16: </span>  <span style="color: #b58900;">}</span>
<span class="linenr">17: </span>  <span style="color: #268bd2;">Cups</span><span style="color: #b58900;">(){</span>
<span class="linenr">18: </span>    print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Cups()"</span><span style="color: #268bd2;">)</span>; 
<span class="linenr">19: </span>  <span style="color: #b58900;">}</span>
<span class="linenr">20: </span><span style="color: #2aa198;">}</span>
<span class="linenr">21: </span>
<span class="linenr">22: </span><span style="color: #859900; font-weight: bold;">public</span> <span style="color: #859900; font-weight: bold;">class</span> <span style="color: #b58900;">ExplicitStatic</span><span style="color: #2aa198;">{</span>
<span class="linenr">23: </span>  <span style="color: #859900; font-weight: bold;">public</span> <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> main<span style="color: #b58900;">(</span>String<span style="color: #268bd2;">[]</span> args<span style="color: #b58900;">){</span>
<span class="linenr">24: </span>    print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Inside main()"</span><span style="color: #268bd2;">)</span>;
<span id="coderef-cupsrun" class="coderef-off"><span class="linenr">25: </span>    Cups.cup1.f<span style="color: #268bd2;">(</span><span style="color: #6c71c4;">99</span><span style="color: #268bd2;">)</span>; (cupsrun)</span>
<span class="linenr">26: </span>  <span style="color: #b58900;">}</span>
<span id="coderef-cupsrun1" class="coderef-off"><span class="linenr">27: </span>  <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">Cups</span> <span style="color: #268bd2;">cups1</span> = <span style="color: #859900; font-weight: bold;">new</span> <span style="color: #b58900;">Cups</span><span style="color: #b58900;">()</span>; (cupsrun1)</span>
<span class="linenr">28: </span><span style="color: #2aa198;">}</span>
</pre>
</div>

<p>
输出为：
</p>
<pre class="example">
Inside main()
Cup(1)
Cup(2)
f(99)
</pre>

<p>
<code>static</code> 初始化语句在下列任一情况下初始化 <code>Cups</code> ：
</p>
<ol class="org-ol">
<li>第<a href="#coderef-cupsrun" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-cupsrun');" onmouseout="CodeHighlightOff(this, 'coderef-cupsrun');">cupsrun</a> 行执行。</li>
<li>第<a href="#coderef-cupsrun" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-cupsrun');" onmouseout="CodeHighlightOff(this, 'coderef-cupsrun');">cupsrun</a> 被注释，第<a href="#coderef-cupsrun1" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-cupsrun1');" onmouseout="CodeHighlightOff(this, 'coderef-cupsrun1');">cupsrun1</a> 行解注；</li>
</ol>

<p>
在情况1， 我们访问了 <code>Cups</code>  的成员变量，这个时候出发了 <code>Cups</code> 类的初始化；在情况2，我们初始化了对象 <code>cups1</code> 。
</p>

<p>
当我们把第 <a href="#coderef-cupsrun1" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-cupsrun1');" onmouseout="CodeHighlightOff(this, 'coderef-cupsrun1');">cupsrun1</a>行解注，第<a href="#coderef-cupsrun" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-cupsrun');" onmouseout="CodeHighlightOff(this, 'coderef-cupsrun');">cupsrun</a> 注释掉之后，输出为：
</p>
<pre class="example">
Cup(1) 
Cup(2)
Cups()
Inside main()
</pre>

<p>
可以看到在类 <code>ExplicitStatic</code> 中，也是 <code>static</code> 变量先初始化。我们看到 <code>Inside main()</code> 最后输出。说明程序先完成了静态成员 <code>cups1</code> 的初始化之后再调用的 <code>main</code> 函数。
</p>

<p>
如果我把第 <a href="#coderef-cupsrun1" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-cupsrun1');" onmouseout="CodeHighlightOff(this, 'coderef-cupsrun1');">cupsrun1</a>行和第<a href="#coderef-cupsrun" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-cupsrun');" onmouseout="CodeHighlightOff(this, 'coderef-cupsrun');">cupsrun</a> 行都解注，则输出：
</p>
<pre class="example">
Cup(1)
Cup(2)
Cups()
Inside main()
f(99)
</pre>
<p>
可以看出还是 <code>static</code> 变量优先，通过第 <a href="#coderef-cupsrun1" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-cupsrun1');" onmouseout="CodeHighlightOff(this, 'coderef-cupsrun1');">cupsrun1</a>行对 <code>Cups</code> 类的静态变量进行了初始化。然后再执行 <code>main</code> 函数。
</p>


<div class="problem">
<p>
Create a class with a <code>static String</code> field that is initialized at the point of definition, and another one that is initialized by the <code>static</code> block. Add a <code>static</code> method that prints both fields and demonstrates that they are both initialized before they are used.
</p>

</div>
<div class="answer">
<p>
首先编写代码，如下
</p>

<div class="org-src-container">
<pre class="src src-C"><span class="linenr"> 1: </span><span style="color: #b58900;">import</span> <span style="color: #859900; font-weight: bold;">static</span> net.mindview.util.Print.*;
<span class="linenr"> 2: </span>
<span class="linenr"> 3: </span><span style="color: #b58900;">class</span> <span style="color: #268bd2;">String1</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 4: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">String</span> <span style="color: #268bd2;">str1</span> = <span style="color: #2aa198;">"string in String1"</span>;
<span class="linenr"> 5: </span>    <span style="color: #268bd2;">String1</span><span style="color: #b58900;">(){</span>
<span class="linenr"> 6: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">""</span> + str1<span style="color: #268bd2;">)</span>;
<span class="linenr"> 7: </span>    <span style="color: #b58900;">}</span>
<span class="linenr"> 8: </span><span style="color: #2aa198;">}</span>
<span class="linenr"> 9: </span><span style="color: #b58900;">class</span> <span style="color: #268bd2;">String2</span><span style="color: #2aa198;">{</span>
<span class="linenr">10: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">String</span> <span style="color: #268bd2;">str2</span>;
<span class="linenr">11: </span>    <span style="color: #859900; font-weight: bold;">static</span><span style="color: #b58900;">{</span>
<span class="linenr">12: </span>        str2 = <span style="color: #2aa198;">"string in string2"</span>;
<span class="linenr">13: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">14: </span>    <span style="color: #268bd2;">String2</span><span style="color: #b58900;">(){</span>
<span class="linenr">15: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">""</span> + str2<span style="color: #268bd2;">)</span>;
<span class="linenr">16: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">17: </span><span style="color: #2aa198;">}</span>
<span class="linenr">18: </span>
<span class="linenr">19: </span>public <span style="color: #b58900;">class</span> <span style="color: #268bd2;">Exercise0614</span><span style="color: #2aa198;">{</span>
<span class="linenr">20: </span>    public <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span><span style="color: #268bd2;">[]</span> args<span style="color: #b58900;">){</span>
<span class="linenr">21: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Inside main()"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">22: </span>        <span style="color: #b58900;">String1</span> <span style="color: #268bd2;">str1</span> = new String1<span style="color: #268bd2;">()</span>;
<span class="linenr">23: </span>        <span style="color: #b58900;">String2</span> <span style="color: #268bd2;">str2</span> = new String2<span style="color: #268bd2;">()</span>;
<span class="linenr">24: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">25: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
输出为：
</p>
<pre class="example">
Inside main()
string in String1
string in string2
</pre>
<p>
之所以按顺序初始化 <code>str1</code> 和 <code>str2</code> ，是因为在 <code>Exercise0614</code> 的类中，这两个变量不是 <code>static</code> ,把这两个类改成 <code>static</code> 的有：
</p>
<div class="org-src-container">
<pre class="src src-C"><span class="linenr"> 1: </span><span style="color: #b58900;">import</span> <span style="color: #859900; font-weight: bold;">static</span> net.mindview.util.Print.*;
<span class="linenr"> 2: </span>
<span class="linenr"> 3: </span><span style="color: #b58900;">class</span> <span style="color: #268bd2;">String1</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 4: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">String</span> <span style="color: #268bd2;">str1</span> = <span style="color: #2aa198;">"string in String1"</span>;
<span class="linenr"> 5: </span>    <span style="color: #268bd2;">String1</span><span style="color: #b58900;">(){</span>
<span class="linenr"> 6: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">""</span> + str1<span style="color: #268bd2;">)</span>;
<span class="linenr"> 7: </span>    <span style="color: #b58900;">}</span>
<span class="linenr"> 8: </span><span style="color: #2aa198;">}</span>
<span class="linenr"> 9: </span><span style="color: #b58900;">class</span> <span style="color: #268bd2;">String2</span><span style="color: #2aa198;">{</span>
<span class="linenr">10: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">String</span> <span style="color: #268bd2;">str2</span>;
<span class="linenr">11: </span>    <span style="color: #859900; font-weight: bold;">static</span><span style="color: #b58900;">{</span>
<span class="linenr">12: </span>        str2 = <span style="color: #2aa198;">"string in string2"</span>;
<span class="linenr">13: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">14: </span>    <span style="color: #268bd2;">String2</span><span style="color: #b58900;">(){</span>
<span class="linenr">15: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">""</span> + str2<span style="color: #268bd2;">)</span>;
<span class="linenr">16: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">17: </span><span style="color: #2aa198;">}</span>
<span class="linenr">18: </span>
<span class="linenr">19: </span>public <span style="color: #b58900;">class</span> <span style="color: #268bd2;">Exercise0614</span><span style="color: #2aa198;">{</span>
<span class="linenr">20: </span>    public <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span><span style="color: #268bd2;">[]</span> args<span style="color: #b58900;">){</span>
<span class="linenr">21: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Inside main()"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">22: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">23: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">String1</span> <span style="color: #268bd2;">str1</span> = new String1<span style="color: #b58900;">()</span>;
<span class="linenr">24: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">String2</span> <span style="color: #268bd2;">str2</span> = new String2<span style="color: #b58900;">()</span>;
<span class="linenr">25: </span>
<span class="linenr">26: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
输出为：
</p>
<pre class="example">
string in String1
string in string2
Inside main()
</pre>

<p>
然后修改代码，为其添加静态函数（静态函数可以在不定义对象的时候调用，而我们调用静态函数的同时，对这个静态函数所属的类初始化，主要是初始化其 <code>static</code> 变量）。
</p>
<div class="org-src-container">
<pre class="src src-C"><span class="linenr"> 1: </span><span style="color: #b58900;">import</span> <span style="color: #859900; font-weight: bold;">static</span> net.mindview.util.Print.*;
<span class="linenr"> 2: </span>
<span class="linenr"> 3: </span><span style="color: #b58900;">class</span> <span style="color: #268bd2;">String1</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 4: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">String</span> <span style="color: #268bd2;">str1</span> = <span style="color: #2aa198;">"string in String1"</span>;
<span class="linenr"> 5: </span>    <span style="color: #268bd2;">String1</span><span style="color: #b58900;">(){</span>
<span class="linenr"> 6: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"construct 1"</span> + str1<span style="color: #268bd2;">)</span>;
<span class="linenr"> 7: </span>    <span style="color: #b58900;">}</span>
<span class="linenr"> 8: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">f1</span><span style="color: #b58900;">(){</span>
<span class="linenr"> 9: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"static method"</span> + str1<span style="color: #268bd2;">)</span>;
<span class="linenr">10: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">11: </span><span style="color: #2aa198;">}</span>
<span class="linenr">12: </span><span style="color: #b58900;">class</span> <span style="color: #268bd2;">String2</span><span style="color: #2aa198;">{</span>
<span class="linenr">13: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">String</span> <span style="color: #268bd2;">str2</span>;
<span class="linenr">14: </span>    <span style="color: #859900; font-weight: bold;">static</span><span style="color: #b58900;">{</span>
<span class="linenr">15: </span>        str2 = <span style="color: #2aa198;">"string in string2"</span>;
<span class="linenr">16: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">17: </span>    <span style="color: #268bd2;">String2</span><span style="color: #b58900;">(){</span>
<span class="linenr">18: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"constructor 2"</span> + str2<span style="color: #268bd2;">)</span>;
<span class="linenr">19: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">20: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">f2</span><span style="color: #b58900;">(){</span>
<span class="linenr">21: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"static method"</span> + str2<span style="color: #268bd2;">)</span>;
<span class="linenr">22: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">23: </span><span style="color: #2aa198;">}</span>
<span class="linenr">24: </span>
<span class="linenr">25: </span>public <span style="color: #b58900;">class</span> <span style="color: #268bd2;">Exercise0614</span><span style="color: #2aa198;">{</span>
<span class="linenr">26: </span>    public <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span><span style="color: #268bd2;">[]</span> args<span style="color: #b58900;">){</span>
<span class="linenr">27: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Inside main()"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">28: </span>        String2.f2<span style="color: #268bd2;">()</span>;
<span class="linenr">29: </span>        String1.f1<span style="color: #268bd2;">()</span>;
<span class="linenr">30: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">31: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">String2</span> <span style="color: #268bd2;">str2</span> = new String2<span style="color: #b58900;">()</span>;
<span class="linenr">32: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
输出为：
</p>
<pre class="example">
constructor 2string in string2
Inside main()
static methodstring in string2
static methodstring in String1
</pre>

</div>
</div>
</div>
<div id="outline-container-orgd716c04" class="outline-2">
<h2 id="orgd716c04"><span class="section-number-2">11</span> 非静态实例初始化</h2>
<div class="outline-text-2" id="text-11">
<p>

</p>

<p>
对于非静态变量， java提供了类似于 <code>static</code> 块的初始化方式。看代码：
</p>

<div class="org-src-container">
<pre class="src src-C"><span class="linenr"> 1: </span><span style="color: #b58900;">import</span> <span style="color: #859900; font-weight: bold;">static</span> net.mindview.util.Print.*;
<span class="linenr"> 2: </span>
<span class="linenr"> 3: </span><span style="color: #b58900;">class</span> <span style="color: #268bd2;">Mug</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 4: </span>    <span style="color: #268bd2;">Mug</span><span style="color: #b58900;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">marker</span><span style="color: #b58900;">){</span>
<span class="linenr"> 5: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Mug("</span>  + marker +<span style="color: #2aa198;">")"</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 6: </span>    <span style="color: #b58900;">}</span>
<span class="linenr"> 7: </span>    <span style="color: #b58900;">void</span> <span style="color: #268bd2;">f</span><span style="color: #b58900;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">marker</span><span style="color: #b58900;">){</span>
<span class="linenr"> 8: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"f("</span> + marker + <span style="color: #2aa198;">")"</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 9: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">10: </span><span style="color: #2aa198;">}</span>
<span class="linenr">11: </span>public <span style="color: #b58900;">class</span> <span style="color: #268bd2;">Mugs</span><span style="color: #2aa198;">{</span>
<span class="linenr">12: </span>    <span style="color: #b58900;">Mug</span> <span style="color: #268bd2;">mug1</span>;
<span class="linenr">13: </span>    <span style="color: #b58900;">Mug</span> <span style="color: #268bd2;">mug2</span>;
<span class="linenr">14: </span>    <span style="color: #b58900;">{</span>
<span class="linenr">15: </span>        mug1 = new Mug<span style="color: #268bd2;">(</span><span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span>;
<span class="linenr">16: </span>        mug2 = new Mug<span style="color: #268bd2;">(</span><span style="color: #6c71c4;">2</span><span style="color: #268bd2;">)</span>;
<span class="linenr">17: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"mug1 &amp; mug2 initialized"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">18: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">19: </span>    <span style="color: #268bd2;">Mugs</span><span style="color: #b58900;">(){</span>
<span class="linenr">20: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Mugs()"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">21: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">22: </span>    <span style="color: #268bd2;">Mugs</span><span style="color: #b58900;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">i</span><span style="color: #b58900;">){</span>
<span class="linenr">23: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Mugs(int)"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">24: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">25: </span>    public <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span><span style="color: #268bd2;">[]</span> args<span style="color: #b58900;">){</span>
<span class="linenr">26: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"Inside main()"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">27: </span>        <span style="color: #b58900;">new</span> <span style="color: #268bd2;">Mugs</span><span style="color: #268bd2;">()</span>;
<span class="linenr">28: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"new Mugs() completed"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">29: </span>        <span style="color: #b58900;">new</span> <span style="color: #268bd2;">Mugs</span><span style="color: #268bd2;">(</span><span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span>;
<span class="linenr">30: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"new Mugs(1) completed"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">31: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">32: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
输出为：
</p>
<pre class="example">
Inside main()
Mug(1)
Mug(2)
mug1 &amp; mug2 initialized
Mugs()
new Mugs() completed
Mug(1)
Mug(2)
mug1 &amp; mug2 initialized
Mugs(int)
new Mugs(1) completed
</pre>
<p>
从这个输出可以看出，实例可以按照顺序初始化，没有像 <code>static</code> 一样执行顺序和代码出现顺序不一样的情况。
</p>
</div>
</div>
<div id="outline-container-org5e7a1d9" class="outline-2">
<h2 id="org5e7a1d9"><span class="section-number-2">12</span> 数组初始化</h2>
<div class="outline-text-2" id="text-12">
<p>

</p>

<p>
数组是一些相同类型元素的集合。这些元素可以是基础类型也可以是某个类（这么说可能有些不严谨，基础类型也是类，在Java中一切都是类。）。
</p>

<p>
定义一个整型数组可以使用 <code>int[] a1;</code> 也可以用 <code>int a1[]</code> 。在 <code>Java</code> 中，数组的初始化可以通过大括号实现，也可以不初始化。 <code>Java</code> 中，数组名的赋值，复制的是引用。看代码：
</p>
<div class="org-src-container">
<pre class="src src-c"><span class="linenr"> 1: </span><span style="color: #b58900;">import</span> <span style="color: #859900; font-weight: bold;">static</span> net.mindview.util.Print.*;
<span class="linenr"> 2: </span>
<span class="linenr"> 3: </span>public <span style="color: #b58900;">class</span> <span style="color: #268bd2;">ArrayOfPrimitives</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 4: </span>    public <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span><span style="color: #268bd2;">[]</span> args<span style="color: #b58900;">){</span>
<span class="linenr"> 5: </span>        <span style="color: #b58900;">int</span><span style="color: #268bd2;">[]</span> a1 = <span style="color: #268bd2;">{</span><span style="color: #6c71c4;">1</span>,<span style="color: #6c71c4;">2</span>,<span style="color: #6c71c4;">3</span>,<span style="color: #6c71c4;">4</span>,<span style="color: #6c71c4;">5</span><span style="color: #268bd2;">}</span>;
<span class="linenr"> 6: </span>        <span style="color: #b58900;">int</span><span style="color: #268bd2;">[]</span> a2;
<span class="linenr"> 7: </span>        a2 = a1;
<span class="linenr"> 8: </span>        <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">i</span> = <span style="color: #6c71c4;">0</span>; i &lt; a1.length; i++<span style="color: #268bd2;">)</span> <span style="color: #268bd2;">{</span>
<span class="linenr"> 9: </span>            a2<span style="color: #6c71c4;">[</span>i<span style="color: #6c71c4;">]</span> = a2<span style="color: #6c71c4;">[</span>i<span style="color: #6c71c4;">]</span>*<span style="color: #6c71c4;">2</span>;
<span class="linenr">10: </span>        <span style="color: #268bd2;">}</span>
<span class="linenr">11: </span>        <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">i</span> = <span style="color: #6c71c4;">0</span>; i &lt; a1.length; i++<span style="color: #268bd2;">)</span> <span style="color: #268bd2;">{</span>
<span class="linenr">12: </span>            print<span style="color: #6c71c4;">(</span><span style="color: #2aa198;">"a1["</span> + i + <span style="color: #2aa198;">"]= "</span> + a1<span style="color: #859900;">[</span>i<span style="color: #859900;">]</span><span style="color: #6c71c4;">)</span>;
<span class="linenr">13: </span>        <span style="color: #268bd2;">}</span>
<span class="linenr">14: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">15: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
输出是：
</p>
<pre class="example">
a1[0]= 2
a1[1]= 4
a1[2]= 6
a1[3]= 8
a1[4]= 10
</pre>
<p>
可以看到执行了 <code>a2=a1</code> 之后， <code>a2</code> 指向的内容和 <code>a1</code> 指向的内容是一样的。 这时候即使对 <code>a2</code> 进行修改， <code>a1</code> 的内容也同时发生了改变。
</p>

<p>
关于数组越界的问题在 <code>C/C++</code> 和 <code>Java</code> 中有不同的处理方法： <code>C/C++</code> 不会对数组越界进行约束，而 <code>Java</code> 会。在 <code>Java</code> 中，一旦数组越界就会报错。 虽然适时的检查会不会报错是一件很低效的事情，但是为了开发效率， <code>Java</code> 的设计者认为这是值得的。
</p>

<p>
对于事先不知道长度的数组，需要用 <code>new</code> 来为其分配空间，看代码：
</p>

<div class="org-src-container">
<pre class="src src-c"><span class="linenr"> 1: </span><span style="color: #b58900;">import</span> <span style="color: #268bd2;">java</span>.util.*;
<span class="linenr"> 2: </span><span style="color: #b58900;">import</span> <span style="color: #859900; font-weight: bold;">static</span> net.mindview.util.Print.*;
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span>public <span style="color: #b58900;">class</span> <span style="color: #268bd2;">ArrayNew</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 5: </span>    public <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span><span style="color: #268bd2;">[]</span> args<span style="color: #b58900;">){</span>
<span class="linenr"> 6: </span>        <span style="color: #b58900;">int</span> <span style="color: #268bd2;">[]</span> a;
<span class="linenr"> 7: </span>        <span style="color: #b58900;">Random</span> <span style="color: #268bd2;">rand</span> = new Random<span style="color: #268bd2;">(</span><span style="color: #6c71c4;">47</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 8: </span>        a = new <span style="color: #b58900;">int</span><span style="color: #268bd2;">[</span>rand.nextInt<span style="color: #6c71c4;">(</span><span style="color: #6c71c4;">20</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">]</span>;
<span class="linenr"> 9: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"length of a = "</span> + a.length <span style="color: #268bd2;">)</span>;
<span class="linenr">10: </span>        print<span style="color: #268bd2;">(</span>Arrays.toString<span style="color: #6c71c4;">(</span>a<span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span>;
<span class="linenr">11: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">12: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
输出为：
</p>
<pre class="example">
length of a = 18
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
</pre>

<p>
之前创建了 <code>primitive</code> 的数组。现在创建对象数组，当创建对象数组时，数组元素是对象的索引。现在考虑创建 <code>Integer</code> 数组。（回忆一下 <code>Integer</code> 是类不是primitive类型。 基础类型和类的区别是，基础类型保存在栈上，而对象保存在堆上。）
</p>

<div class="org-src-container">
<pre class="src src-c"><span class="linenr"> 1: </span><span style="color: #b58900;">import</span> <span style="color: #268bd2;">java</span>.util.*;
<span class="linenr"> 2: </span><span style="color: #b58900;">import</span> <span style="color: #859900; font-weight: bold;">static</span> net.mindview.util.Print.*;
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span>public <span style="color: #b58900;">class</span> <span style="color: #268bd2;">ArrayClassObj</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 5: </span>    public <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span><span style="color: #268bd2;">[]</span> args<span style="color: #b58900;">){</span>
<span class="linenr"> 6: </span>        <span style="color: #b58900;">Random</span> <span style="color: #268bd2;">rand</span> = new Random<span style="color: #268bd2;">(</span><span style="color: #6c71c4;">47</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 7: </span>        Integer<span style="color: #268bd2;">[]</span> a = new Integer<span style="color: #268bd2;">[</span>rand.nextInt<span style="color: #6c71c4;">(</span><span style="color: #6c71c4;">10</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">]</span>;
<span class="linenr"> 8: </span>        print<span style="color: #268bd2;">(</span>Arrays.toString<span style="color: #6c71c4;">(</span>a<span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 9: </span>        print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"length of a = "</span> + a.length<span style="color: #268bd2;">)</span>;
<span class="linenr">10: </span>        <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">i</span> = <span style="color: #6c71c4;">0</span>; i &lt; a.length; i++<span style="color: #268bd2;">)</span> <span style="color: #268bd2;">{</span>
<span class="linenr">11: </span>            a<span style="color: #6c71c4;">[</span>i<span style="color: #6c71c4;">]</span> = rand.nextInt<span style="color: #6c71c4;">(</span><span style="color: #6c71c4;">500</span><span style="color: #6c71c4;">)</span>;
<span class="linenr">12: </span>        <span style="color: #268bd2;">}</span>
<span class="linenr">13: </span>        print<span style="color: #268bd2;">(</span>Arrays.toString<span style="color: #6c71c4;">(</span>a<span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span>;
<span class="linenr">14: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">15: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
输出是：
</p>
<pre class="example">
[null, null, null, null, null, null, null, null]
length of a = 8
[55, 193, 361, 461, 429, 368, 200, 22]
</pre>
<p>
从代码可以看出，没有初始化之前打印输出的都是 <code>null</code> 而不是像基础类型那样初始化为 <code>0</code> ，只有初始化之后才会有数据打印。在创建对象数组时，即使使用 <code>new</code> 也没有初始化这个数组，必须一个一个来。
</p>

<p>
对于对象数组也可以用大括号进行初始化，看代码：
</p>
<div class="org-src-container">
<pre class="src src-c"><span class="linenr"> 1: </span><span style="color: #b58900;">import</span> <span style="color: #268bd2;">java</span>.util.*;
<span class="linenr"> 2: </span>
<span class="linenr"> 3: </span>public <span style="color: #b58900;">class</span> <span style="color: #268bd2;">ArrayInit</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 4: </span>    public <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span><span style="color: #268bd2;">[]</span> args<span style="color: #b58900;">){</span>
<span class="linenr"> 5: </span>        Integer<span style="color: #268bd2;">[]</span> a = <span style="color: #268bd2;">{</span>
<span class="linenr"> 6: </span>            <span style="color: #b58900;">new</span> <span style="color: #268bd2;">Integer</span><span style="color: #6c71c4;">(</span><span style="color: #6c71c4;">1</span><span style="color: #6c71c4;">)</span>,
<span class="linenr"> 7: </span>            <span style="color: #268bd2;">new</span> Integer<span style="color: #6c71c4;">(</span><span style="color: #6c71c4;">2</span><span style="color: #6c71c4;">)</span>,
<span class="linenr"> 8: </span>            <span style="color: #6c71c4;">3</span>,
<span class="linenr"> 9: </span>        <span style="color: #268bd2;">}</span>;
<span class="linenr">10: </span>        Integer<span style="color: #268bd2;">[]</span> b = new Integer<span style="color: #268bd2;">[]{</span>
<span class="linenr">11: </span>            <span style="color: #b58900;">new</span> <span style="color: #268bd2;">Integer</span><span style="color: #6c71c4;">(</span><span style="color: #6c71c4;">1</span><span style="color: #6c71c4;">)</span>,
<span class="linenr">12: </span>            <span style="color: #268bd2;">new</span> Integer<span style="color: #6c71c4;">(</span><span style="color: #6c71c4;">2</span><span style="color: #6c71c4;">)</span>,
<span class="linenr">13: </span>            <span style="color: #6c71c4;">3</span>,
<span class="linenr">14: </span>        <span style="color: #268bd2;">}</span>;
<span class="linenr">15: </span>        System.out.println<span style="color: #268bd2;">(</span>Arrays.toString<span style="color: #6c71c4;">(</span>a<span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span>;
<span class="linenr">16: </span>        System.out.println<span style="color: #268bd2;">(</span>Arrays.toString<span style="color: #6c71c4;">(</span>b<span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span>;
<span class="linenr">17: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">18: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
输出为：
</p>
<pre class="example">
[1, 2, 3]
[1, 2, 3]
</pre>

<p>
注意初始化对象数组时，最后一个元素后面的逗号。使用这个逗号写出的代码便于维护，尤其是维护长数组。可以用这种初始化方法传递变长参数。看代码：
</p>

<div class="org-src-container">
<pre class="src src-c"><span class="linenr"> 1: </span><span style="color: #b58900;">class</span> <span style="color: #268bd2;">A</span><span style="color: #2aa198;">{}</span>
<span class="linenr"> 2: </span>
<span class="linenr"> 3: </span>public <span style="color: #b58900;">class</span> <span style="color: #268bd2;">VarArgs</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 4: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">printArray</span><span style="color: #b58900;">(</span><span style="color: #b58900;">Object</span><span style="color: #268bd2;">[]</span> args<span style="color: #b58900;">){</span>
<span class="linenr"> 5: </span>        <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">(</span><span style="color: #b58900;">Object</span> <span style="color: #268bd2;">obj</span>: args<span style="color: #268bd2;">)</span>
<span class="linenr"> 6: </span>            System.out.print<span style="color: #268bd2;">(</span>obj + <span style="color: #2aa198;">" "</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 7: </span>        System.out.println<span style="color: #268bd2;">()</span>;
<span class="linenr"> 8: </span>    <span style="color: #b58900;">}</span>
<span class="linenr"> 9: </span>    public <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span><span style="color: #268bd2;">[]</span> args<span style="color: #b58900;">){</span>
<span class="linenr">10: </span>        printArray<span style="color: #268bd2;">(</span><span style="color: #b58900;">new</span> <span style="color: #268bd2;">Object</span><span style="color: #6c71c4;">[]{</span>
<span class="linenr">11: </span>                <span style="color: #b58900;">new</span> <span style="color: #268bd2;">Integer</span><span style="color: #859900;">(</span><span style="color: #6c71c4;">47</span><span style="color: #859900;">)</span>, <span style="color: #268bd2;">new</span> Float<span style="color: #859900;">(</span><span style="color: #6c71c4;">3.14</span><span style="color: #859900;">)</span>,<span style="color: #268bd2;">new</span> Double<span style="color: #859900;">(</span><span style="color: #6c71c4;">11.11</span><span style="color: #859900;">)</span>,
<span class="linenr">12: </span>            <span style="color: #6c71c4;">}</span><span style="color: #268bd2;">)</span>;
<span class="linenr">13: </span>        printArray<span style="color: #268bd2;">(</span><span style="color: #b58900;">new</span> <span style="color: #268bd2;">Object</span><span style="color: #6c71c4;">[]{</span><span style="color: #2aa198;">"one"</span>,<span style="color: #2aa198;">"two"</span>,<span style="color: #2aa198;">"three"</span><span style="color: #6c71c4;">}</span><span style="color: #268bd2;">)</span>;
<span class="linenr">14: </span>        printArray<span style="color: #268bd2;">(</span><span style="color: #b58900;">new</span> <span style="color: #268bd2;">Object</span><span style="color: #6c71c4;">[]{</span><span style="color: #b58900;">new</span> <span style="color: #268bd2;">A</span><span style="color: #859900;">()</span>,<span style="color: #268bd2;">new</span> A<span style="color: #859900;">()</span>,<span style="color: #268bd2;">new</span> A<span style="color: #859900;">()</span><span style="color: #6c71c4;">}</span><span style="color: #268bd2;">)</span>;
<span class="linenr">15: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">16: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
输出是：
</p>
<pre class="example">
47 3.14 11.11 
one two three 
A@15db9742 A@6d06d69c A@7852e922
</pre>
<p>
上面代码的 <code>Object</code> 共有的根类，关于这个类，我们后面还会学到更多。因为所有类都是从 <code>Object</code> 继承而来，所以可以把 <code>Object</code> 数组传入一个方法。
</p>

<p>
另外我们还可以看到， <code>print</code> 函数接收一个 <code>Object</code> 的数组，然后用 <code>foreach</code> 的循环语法打印每个 <code>Object</code> 数组中 <code>reference</code> 对应的内容。打印标准的 <code>Java</code> 库类输出具有较强的可读性（看输出的前两行），打印自定义的类的输出（输出的第三行）就有点不知所云。不过从输出的第三行可以看出打印自定义类，其输出具有固定的格式，都是类名跟上 <code>@</code> 然后是一串十六进制数（以后我们会了解到，这串十六进制数是对象地址）。
</p>

<p>
上面的这段代码在 Java SE5之前比较常见，但是自从 Java SE5之后，就有更方便的写法了：可以像  <code>printArray()</code> 那样打印数组（我现在写这个笔记的时候用的是SE8，所以浪费了一段时间学习了一个历史技术。）。
</p>

<p>
看代码：
</p>
<div class="org-src-container">
<pre class="src src-c"><span class="linenr"> 1: </span>public <span style="color: #b58900;">class</span> <span style="color: #268bd2;">NewVarArgs</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 2: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">printArray</span><span style="color: #b58900;">(</span><span style="color: #b58900;">Object</span>... <span style="color: #268bd2;">args</span><span style="color: #b58900;">){</span>
<span class="linenr"> 3: </span>        <span style="color: #859900; font-weight: bold;">for</span> <span style="color: #268bd2;">(</span><span style="color: #b58900;">Object</span> <span style="color: #268bd2;">obj</span> : args<span style="color: #268bd2;">)</span> <span style="color: #268bd2;">{</span>
<span class="linenr"> 4: </span>            System.out.print<span style="color: #6c71c4;">(</span>obj + <span style="color: #2aa198;">" "</span><span style="color: #6c71c4;">)</span>;
<span class="linenr"> 5: </span>        <span style="color: #268bd2;">}</span>
<span class="linenr"> 6: </span>        System.out.println<span style="color: #268bd2;">()</span>;
<span class="linenr"> 7: </span>    <span style="color: #b58900;">}</span>
<span class="linenr"> 8: </span>    public <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span><span style="color: #268bd2;">[]</span> args<span style="color: #b58900;">){</span>
<span class="linenr"> 9: </span>        printArray<span style="color: #268bd2;">(</span><span style="color: #b58900;">new</span> <span style="color: #268bd2;">Integer</span><span style="color: #6c71c4;">(</span><span style="color: #6c71c4;">47</span><span style="color: #6c71c4;">)</span>,<span style="color: #b58900;">new</span> <span style="color: #268bd2;">Float</span><span style="color: #6c71c4;">(</span><span style="color: #6c71c4;">3.14</span><span style="color: #6c71c4;">)</span>,<span style="color: #b58900;">new</span> <span style="color: #268bd2;">Double</span><span style="color: #6c71c4;">(</span><span style="color: #6c71c4;">11.11</span><span style="color: #6c71c4;">)</span><span style="color: #268bd2;">)</span>;
<span class="linenr">10: </span>        printArray<span style="color: #268bd2;">(</span><span style="color: #6c71c4;">47</span>,<span style="color: #6c71c4;">3.14F</span>,<span style="color: #6c71c4;">11.11</span><span style="color: #268bd2;">)</span>; 
<span class="linenr">11: </span>        printArray<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"one"</span>,<span style="color: #2aa198;">"two"</span>,<span style="color: #2aa198;">"three"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">12: </span>        printArray<span style="color: #268bd2;">(</span><span style="color: #b58900;">new</span> <span style="color: #b58900;">A</span><span style="color: #6c71c4;">()</span>,<span style="color: #b58900;">new</span> <span style="color: #b58900;">A</span><span style="color: #6c71c4;">()</span>,<span style="color: #b58900;">new</span> <span style="color: #b58900;">A</span><span style="color: #6c71c4;">()</span><span style="color: #268bd2;">)</span>;
<span id="coderef-NewVarArgsline2" class="coderef-off"><span class="linenr">13: </span>        printArray<span style="color: #268bd2;">(</span><span style="color: #6c71c4;">(</span><span style="color: #b58900;">Object</span><span style="color: #859900;">[]</span><span style="color: #6c71c4;">)</span><span style="color: #b58900;">new</span> <span style="color: #268bd2;">Integer</span><span style="color: #6c71c4;">[]{</span><span style="color: #6c71c4;">1</span>,<span style="color: #6c71c4;">2</span>,<span style="color: #6c71c4;">3</span>,<span style="color: #6c71c4;">4</span><span style="color: #6c71c4;">}</span><span style="color: #268bd2;">)</span>; (NewVarArgsline2)</span>
<span class="linenr">14: </span>        printArray<span style="color: #268bd2;">()</span>;<span style="color: #586e75;">//</span><span style="color: #586e75;">Empth list is also OK;</span>
<span class="linenr">15: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">16: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
输出为：
</p>
<pre class="example">
47 3.14 11.11 
47 3.14 11.11 
one two three 
A@15db9742 A@6d06d69c A@7852e922 
1 2 3 4
</pre>

<p>
开心的服下这颗语法糖。
</p>

<p>
当你使用 <code>varargs</code> 时，不在需要写明数组信息，编译器会自动帮你填写。编译器会给 <code>print()</code> 函数一个 <code>array</code> 。但是注意这里不仅仅是从一个元素列表到一个数组的转换。注意代码中第<a href="#coderef-NewVarArgsline2" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-NewVarArgsline2');" onmouseout="CodeHighlightOff(this, 'coderef-NewVarArgsline2');">NewVarArgsline2</a> 行，我们可以看到一个 <code>Integer</code> 数组转换成了一个 <code>Object</code> 数组。 <i>在编译过程中，编译器看到这是一个数组，并不会做转换</i>  （对这句话我还没有深刻的理解，需要以后回头看）。
</p>

<p>
最后一行代码告诉我们，可以对一个 <code>vararg</code> 的列表传送零个参数。这个语法很有用，尤其是当函数的尾随参数个数可变时。关于尾随参数，看代码：
</p>
<div class="org-src-container">
<pre class="src src-c"><span class="linenr"> 1: </span>public <span style="color: #b58900;">class</span> <span style="color: #268bd2;">OptionalTrailingArguments</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 2: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">f</span><span style="color: #b58900;">(</span><span style="color: #b58900;">int</span> <span style="color: #268bd2;">required</span>, <span style="color: #b58900;">String</span>... <span style="color: #268bd2;">trailing</span><span style="color: #b58900;">){</span>
<span class="linenr"> 3: </span>        System.out.print<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"required: "</span> + required + <span style="color: #2aa198;">" "</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 4: </span>
<span class="linenr"> 5: </span>        <span style="color: #859900; font-weight: bold;">for</span><span style="color: #268bd2;">(</span><span style="color: #b58900;">String</span> <span style="color: #268bd2;">s</span>: trailing<span style="color: #268bd2;">)</span>
<span class="linenr"> 6: </span>            System.out.print<span style="color: #268bd2;">(</span>s + <span style="color: #2aa198;">" "</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 7: </span>        System.out.println<span style="color: #268bd2;">()</span>;
<span class="linenr"> 8: </span>    <span style="color: #b58900;">}</span>
<span class="linenr"> 9: </span>    public <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span><span style="color: #268bd2;">[]</span> args<span style="color: #b58900;">){</span>
<span class="linenr">10: </span>        f<span style="color: #268bd2;">(</span><span style="color: #6c71c4;">1</span>,<span style="color: #2aa198;">"one"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">11: </span>        f<span style="color: #268bd2;">(</span><span style="color: #6c71c4;">2</span>,<span style="color: #2aa198;">"two"</span>,<span style="color: #2aa198;">"three"</span><span style="color: #268bd2;">)</span>;
<span class="linenr">12: </span>        f<span style="color: #268bd2;">(</span><span style="color: #6c71c4;">0</span><span style="color: #268bd2;">)</span>;
<span class="linenr">13: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">14: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
输出为：
</p>
<pre class="example">
required: 1 one 
required: 2 two three 
required: 0
</pre>

<p>
从上面代码还可以看出，可以使用除了 <code>Object</code> 之外的类型作为 <code>varargs</code> 的类型（在这里例子中，我们实用的是 <code>String</code> ）。事实上，可以使用任何类型作为可变参数类型。看代码：
</p>
<div class="org-src-container">
<pre class="src src-c"><span class="linenr"> 1: </span>public <span style="color: #b58900;">class</span> <span style="color: #268bd2;">VarargType</span><span style="color: #2aa198;">{</span>
<span class="linenr"> 2: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">f</span><span style="color: #b58900;">(</span><span style="color: #b58900;">Character</span>... <span style="color: #268bd2;">args</span><span style="color: #b58900;">){</span>
<span class="linenr"> 3: </span>        System.out.print<span style="color: #268bd2;">(</span>args.getClass<span style="color: #6c71c4;">()</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 4: </span>        System.out.println<span style="color: #268bd2;">(</span><span style="color: #2aa198;">" length "</span> + args.length<span style="color: #268bd2;">)</span>;
<span class="linenr"> 5: </span>    <span style="color: #b58900;">}</span>
<span class="linenr"> 6: </span>    <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">g</span><span style="color: #b58900;">(</span><span style="color: #b58900;">int</span> ... <span style="color: #268bd2;">args</span><span style="color: #b58900;">){</span>
<span class="linenr"> 7: </span>        System.out.print<span style="color: #268bd2;">(</span>args.getClass<span style="color: #6c71c4;">()</span><span style="color: #268bd2;">)</span>;
<span class="linenr"> 8: </span>        System.out.println<span style="color: #268bd2;">(</span><span style="color: #2aa198;">" length "</span> + args.length<span style="color: #268bd2;">)</span>;
<span class="linenr"> 9: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">10: </span>    public <span style="color: #859900; font-weight: bold;">static</span> <span style="color: #b58900;">void</span> <span style="color: #268bd2;">main</span><span style="color: #b58900;">(</span><span style="color: #b58900;">String</span><span style="color: #268bd2;">[]</span> args<span style="color: #b58900;">){</span>
<span class="linenr">11: </span>        f<span style="color: #268bd2;">(</span><span style="color: #2aa198;">'a'</span><span style="color: #268bd2;">)</span>;
<span class="linenr">12: </span>        f<span style="color: #268bd2;">()</span>;
<span class="linenr">13: </span>        g<span style="color: #268bd2;">(</span><span style="color: #6c71c4;">1</span><span style="color: #268bd2;">)</span>;
<span class="linenr">14: </span>        g<span style="color: #268bd2;">()</span>;
<span class="linenr">15: </span>        System.out.println<span style="color: #268bd2;">(</span><span style="color: #2aa198;">"int []: "</span> + new <span style="color: #b58900;">int</span><span style="color: #6c71c4;">[</span><span style="color: #6c71c4;">0</span><span style="color: #6c71c4;">]</span>.getClass<span style="color: #6c71c4;">()</span><span style="color: #268bd2;">)</span>;
<span class="linenr">16: </span>    <span style="color: #b58900;">}</span>
<span class="linenr">17: </span><span style="color: #2aa198;">}</span>
</pre>
</div>
<p>
输出为：
</p>
<pre class="example">
class [Ljava.lang.Character; length 1
class [Ljava.lang.Character; length 0
class [I length 1
class [I length 0
int []: class [I
</pre>

<p>
从上面的代码可以看出，可以使用 <code>Character</code> 数组作为可变参数类型，也可以使用 <code>int</code> 这种基础类型作为可变参数类型。 <code>getClass()</code> 函数是 <code>Object</code> 的内置函数。 
</p>
</div>
</div>
</div>
<div id="postamble" class="status">
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'zclspace';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</div>
</body>
</html>
